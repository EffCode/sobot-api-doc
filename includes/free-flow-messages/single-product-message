<h2 id='single-product-message'>Single Product Message</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--globoff</span> <span class="s1">'https://api.sobot.in/message/'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'x-api-key: yourapiaccesskey'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'x-api-secret: yourapisecretkey'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'content-type'</span>: <span class="s1">'application/json'</span> <span class="se">\</span>
<span class="nt">--data</span> <span class="s1">'{
          "message":"Hello",
          "customer_number":"919970XXXXXX",
          "customer_name": "John Doe",
          "type": "product",
          "caption": "This will go in footer",
          "product_list": {"product_retailer_id": "sbt_in_4_1"}       
}'</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.sobot.in/message/"</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span>
  <span class="p">{</span>
          <span class="s">"message"</span><span class="p">:</span><span class="s">"Hello"</span><span class="p">,</span>
          <span class="s">"customer_number"</span><span class="p">:</span><span class="s">"919970XXXXXX"</span><span class="p">,</span>
          <span class="s">"customer_name"</span><span class="p">:</span> <span class="s">"John Doe"</span><span class="p">,</span>
          <span class="s">"type"</span><span class="p">:</span> <span class="s">"product"</span><span class="p">,</span>
          <span class="s">"caption"</span><span class="p">:</span> <span class="s">"This will go in footer"</span><span class="p">,</span>
          <span class="s">"product_list"</span><span class="p">:</span> <span class="p">{</span><span class="s">"product_retailer_id"</span><span class="p">:</span> <span class="s">"sbt_in_4_1"</span><span class="p">}</span>       
<span class="p">}</span>
<span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'x-api-key'</span><span class="p">:</span> <span class="s">'yourapiaccesskey'</span><span class="p">,</span>
  <span class="s">'x-api-secret'</span><span class="p">:</span> <span class="s">'yourapisecretkey'</span><span class="p">,</span>
  <span class="s">'content-type'</span><span class="p">:</span> <span class="s">'application/json'</span>
<span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">request</span><span class="p">(</span><span class="s">"POST"</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="k">require_once</span> <span class="s1">'HTTP/Request2.php'</span><span class="p">;</span>
<span class="nv">$request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTTP_Request2</span><span class="p">();</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">setUrl</span><span class="p">(</span><span class="s1">'https://api.sobot.in/message/'</span><span class="p">);</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">setMethod</span><span class="p">(</span><span class="n">HTTP_Request2</span><span class="o">::</span><span class="no">METHOD_POST</span><span class="p">);</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">setConfig</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
  <span class="s1">'follow_redirects'</span> <span class="o">=&gt;</span> <span class="kc">TRUE</span>
<span class="p">));</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">setHeader</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
  <span class="s1">'x-api-key'</span> <span class="o">=&gt;</span> <span class="s1">'yourapiaccesskey'</span><span class="p">,</span>
  <span class="s1">'x-api-secret'</span> <span class="o">=&gt;</span> <span class="s1">'yourapisecretkey'</span><span class="p">,</span>
  <span class="s1">'content-type'</span> <span class="o">=&gt;</span> <span class="s1">'application/json'</span>
<span class="p">));</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">setBody</span><span class="p">(</span><span class="s1">'{\n
          "message":"Hello",\n
          "customer_number":"919970XXXXXX",\n
          "customer_name": "John Doe",\n
          "type": "product",\n
          "caption": "This will go in footer",\n
          "product_list": {"product_retailer_id": "sbt_in_4_1"}\n}'</span>
<span class="p">);</span>

<span class="k">try</span> <span class="p">{</span>
  <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="nf">send</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getStatus</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Unexpected HTTP status: '</span> <span class="mf">.</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getStatus</span><span class="p">()</span> <span class="mf">.</span> <span class="s1">' '</span> <span class="mf">.</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getReasonPhrase</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="n">HTTP_Request2_Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s1">'Error: '</span> <span class="mf">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="nf">getMessage</span><span class="p">();</span>
<span class="p">}</span>

</code></pre></div>
<blockquote>
<p>The above API call returns JSON response like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wamid.HBgMOTE5OTcwNTg1NTU2FQIAERgSQjhGRDQ2REFBQjAxMjJBM0Q1AA=="</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"submitted"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Message sent successfully."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This API allows you to send Single Product messages to customers using the Sobot platform, enabling seamless communication with your customer.</p>

<p>This API needs Meta catalog to be connected to your WhatsApp business account. The catalog id should be updated in Sobot before using this API. This API uses that catalog id as a default for refering all your products with <code>product_retailer_id</code>.</p>

<aside class="warning">
You can only send a text message up until 24 hours after receiving a message from the user. If you have not received a message from the user within this time, you will need to start a new conversation by sending a Template message.
</aside>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST https://api.sobot.in/message/</code></p>
<h3 id='body-parameters'>Body Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>Yes</td>
<td>The text of the text message which can contain URLs which begin with http:// or https://(All URLs are set to preview in message by default.) and formatting (See Below for formattting options) .<br/> <br/> Maximum length: 1024 characters</td>
<td>-</td>
</tr>
<tr>
<td>type</td>
<td>Yes</td>
<td>Type of message contents. Set to <code>product</code> in case of Single Product messages.</td>
<td>-</td>
</tr>
<tr>
<td>customer_number</td>
<td>Yes</td>
<td>WhatsApp phone number of the customer you want to send a message to. <br /> <br />No Plus signs (+), hyphens (-), parenthesis ((,)), and spaces are supported in customer phone number. <br /><br /> We highly recommend that you <strong>include country calling code</strong> when sending a message to a customer. If the country calling code is omitted, your business phone number&#39;s country calling code is prepended to the customer&#39;s phone number. This can result in undelivered or misdelivered messages.</td>
<td>-</td>
</tr>
<tr>
<td>customer_name</td>
<td>Yes</td>
<td>Name of a customer for future reference</td>
<td>-</td>
</tr>
<tr>
<td>product_list</td>
<td>Yes</td>
<td>A object which consist of following parameters. <table><thead><tr><td>Parameter</td><td>Required</td><td>Description</td><tr><thead><tr><td>product_retailer_id</td><td>Yes</td><td>Unique identifier of the product in a catalog. To get this ID go to <a href="https://business.facebook.com/commerce/">Meta Commerce Manager</a> and select your Meta Business account.</td></tr></table></td>
<td>-</td>
</tr>
<tr>
<td>caption</td>
<td>No</td>
<td>The footer content. Emojis, markdown, and links are supported. Maximum length: 60 characters.</td>
<td>-</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<p>In response of successfully sent messages, you will get <code>id</code> &amp; <code>status</code> under <code>data</code> key. Messages are identified by a unique ID (<code>wamid</code>). You can track message status in the Webhooks through its <code>wamid</code>  (Check Webhook Documentation for recieving Status events of sent messages on your webhook). This <code>wamid</code> can have a maximum length of up to 128 characters.</p>
